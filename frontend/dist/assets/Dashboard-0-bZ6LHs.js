import{r as p,a as b,j as e,s as a,D as T,L as d,b as o,d as L,c as D,e as h,g as x,f as E}from"./index-BL4B0tWW.js";import{C as P}from"./ConfirmationModal-wOkbEqns.js";import{E as _}from"./Edit-07mlQYnt.js";function w({content:s,refetch:l,type:r}){const[t,c]=p.useState(!1),g=b();function j(i){let n;r==="list"?n=o("f_EDIT_LIST",["list",i]):r==="blogPost"&&(n=o("f_EDIT_BLOG_POST",["blog-post",i])),g(n)}function m(){L(a(s.title),r).then(i=>{i&&l(),c(!1)})}function u(){c(!t)}return e.jsxs("li",{className:"blog-post",children:[e.jsxs("div",{className:"edit-buttons",children:[" ",e.jsx("button",{onClick:()=>j(a(s.title)),children:e.jsx(_,{})}),e.jsx("button",{onClick:()=>u(),children:e.jsx(T,{})}),e.jsx(P,{helperFunction:m,message:"This will delete your post forever! Are you sure?",toggleOpen:u,isOpen:t})]}),e.jsx(d,{to:r=="list"?o("f_GET_LIST",[s.user.username,a(s.title)]):o("f_GET_BLOG_POST",[s.user.username,a(s.title)]),children:e.jsx("h2",{children:s.title})}),e.jsxs("div",{className:"info",children:[e.jsx("p",{children:"By "+s.user.username}),e.jsx("p",{children:s.created_date.replace(/(T.*)/g,"")})]}),e.jsx("p",{className:"hint","data-testid":"post-content",children:s.content.length>100?s.content.slice(0,101)+"...":s.content})]})}function f({query:s,type:l}){return s.isError||s.data===null?e.jsxs("p",{children:["There was an error fetching data"," ",s.error==null?null:": "+s.error.message]}):s.data.length==null?e.jsx("p",{children:"There's nothing here. Go make some posts!"}):e.jsx("ul",{className:"list",children:s.data.map((r,t)=>e.jsx(w,{content:r,refetch:s.refetch,type:l},t))})}function O(){const s=D("root"),l=h({queryKey:["getBlogPosts"],queryFn:()=>x(s.username,"blogPost"),enabled:!!s.username}),r=h({queryKey:["getLists"],queryFn:()=>x(s.username,"list"),enabled:!!s.username});if(l.isLoading||r.isLoading)return e.jsx(E,{});if(l.isError&&r.isError)return e.jsxs("div",{id:"error-page",children:[e.jsx("h1",{children:"There was an error rendering your dashboard!"}),e.jsx("p",{children:l.error.message}),e.jsx("p",{children:r.error.message})]});if(l.isSuccess||r.isSuccess)return e.jsxs("div",{id:"dashboard",children:[e.jsxs("section",{className:"flex-row-spacing vertical-margin-50",children:[e.jsx("button",{className:"standard-button",children:e.jsx(d,{to:"/followers",children:"View followers"})}),e.jsx("button",{className:"standard-button",children:e.jsx(d,{to:"/following",children:"View following"})})]}),e.jsxs("section",{className:"list-section",children:[e.jsx("h1",{children:"Your posts"}),e.jsx(f,{query:l,type:"blogPost"}),e.jsx("h1",{children:"Your lists"}),e.jsx(f,{query:r,type:"list"})]})]})}export{O as default};

import{v as S,j as e,a1 as z,r as d,c as T,b2 as V,L as C,b9 as c,a3 as L,b4 as w,D as y,a as E,ba as A,bb as k,bc as Y,b8 as B}from"./index-BX5Plg-3.js";import{C as P}from"./Close-Bl2oNI8R.js";import{E as q}from"./Edit-Cbfz6NHS.js";const G=S(e.jsx("path",{d:"M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 16H5V10h14zM9 14H7v-2h2zm4 0h-2v-2h2zm4 0h-2v-2h2zm-8 4H7v-2h2zm4 0h-2v-2h2zm4 0h-2v-2h2z"}),"CalendarMonth"),J=S(e.jsx("path",{d:"M10 9V5l-7 7 7 7v-4.1c5 0 8.5 1.6 11 5.1-1-5-4-10-11-11"}),"Reply");function W({content:s,isReply:x,isNotification:o,refetch:i,isAdminDashboard:m,id:H}){let{username:_,slug:n}=z();n||(n=s.post.slug_field);const[j,f]=d.useState(!0),[D,u]=d.useState(!1),[O,h]=d.useState(!1),b=T("root"),[g,a]=d.useState(!1);V();function N(){a(!1)}function F(t){const l=t.target.dataset.id;k(l).then(r=>{r&&(a(!1),i())})}function I(){k(s.id).then(t=>{t&&(a(!1),i())})}function M(t){t.preventDefault();const l=t.target[1].dataset.id,r=t.target[0].value;Y(l,r).then(p=>{p&&(u(!1),i())})}function R(t){t.preventDefault();const l=t.target[0].value,r=t.target[1].dataset.id;B(_,n,l,r).then(p=>{p&&(h(!1),i())})}const v=e.jsxs(e.Fragment,{children:[e.jsxs("li",{className:(x?"comment comment-reply":"comment")+(s.is_read?" ":" unread-notification"),children:[e.jsxs("div",{className:"top-bar",children:[o?e.jsxs("div",{className:"comment-username-box",children:[j?e.jsx(e.Fragment,{children:s.user.profile_picture!=null?e.jsx("img",{alt:"Profile Picture",className:"pfp",src:s.user.profile_picture,onError:()=>f(!1)}):null}):null,e.jsx("span",{children:s.user.username})]}):e.jsx(C,{to:"/homepage/"+s.user.username,children:e.jsxs("div",{className:"comment-username-box",children:[j?e.jsx(e.Fragment,{children:s.user.profile_picture!=null?e.jsx("img",{alt:"Profile Picture",className:"pfp",src:s.user.profile_picture,onError:()=>f(!1)}):null}):null,e.jsx("span",{children:s.user.username})]})}),e.jsxs("div",{className:"date-field",children:[e.jsxs("div",{className:"sub-date-field",children:[e.jsx(G,{}),e.jsx("p",{children:c(s.created_date)})]}),c(s.created_date)!=c(s.updated_date)?e.jsxs("p",{className:"edited-on",children:["Edited on ",c(s.updated_date)]}):null]}),e.jsx(L,{type:"comment",isFlaggedParam:s.flagged,content:s})]}),D?e.jsxs("form",{onSubmit:t=>M(t),className:"edit-comment-form",children:[e.jsx("textarea",{}),e.jsxs("div",{className:"edit-buttons",children:[e.jsx("button",{type:"submit",className:"tertiary-accent","data-id":s.id,children:"Save"}),e.jsx("button",{className:"accent-highlight",type:"button",id:"close",onClick:()=>u(!1),children:e.jsx(P,{})})]})]}):e.jsx("p",{className:"comment-content","data-testid":"comment"+s.id,children:s.content}),o?null:e.jsxs("div",{className:"edit-buttons",children:[w()&&!m?e.jsx("button",{onClick:()=>h(!0),children:e.jsx(J,{})}):null,b!=null&&b.username==s.user.username&&!m?e.jsxs("div",{className:"edit-buttons right-align",children:[e.jsx("button",{onClick:()=>a(!0),"data-testid":"delete-comment"+s.id,children:e.jsx(y,{})}),e.jsxs(E,{open:g,className:"delete-post-confirm",onClose:N,children:[e.jsx("h1",{children:"This will delete your comment forever! Are you sure?"}),e.jsx("button",{"data-id":s.id,onClick:t=>F(t),className:"accent-border",children:"Yes, I am sure"}),e.jsx("button",{onClick:N,className:"tertiary-border",children:"No, I'm not"})]}),e.jsx("button",{onClick:()=>u(!0),"data-testid":"delete-comment"+s.id,children:e.jsx(q,{})})]}):null,m&&A()?e.jsxs("div",{className:"flex-row-spacing",children:[e.jsx("button",{onClick:()=>a(!0),children:e.jsx(y,{})}),e.jsxs(E,{open:g,className:"delete-post-confirm",onClose:()=>a(!1),children:[e.jsx("h1",{children:"This will delete SOMEONE ELSE'S COMMENT FOREVER!!! Are you sure?"}),e.jsx("button",{onClick:()=>I(),className:"accent-border",children:"Yes, I am sure"}),e.jsx("button",{onClick:()=>a(!1),className:"tertiary-border",children:"No, I'm not"})]})]}):null]})]},H),O?e.jsxs("form",{onSubmit:t=>R(t),className:x?"reply-to-reply-comment-form":"reply-comment-form",children:[e.jsx("textarea",{}),e.jsxs("div",{className:"edit-buttons",children:[e.jsx("button",{type:"submit",className:"tertiary-accent","data-id":s.id,children:"Reply"}),e.jsx("button",{className:"accent-highlight",type:"button",id:"close",onClick:()=>h(!1),children:e.jsx(P,{})})]})]}):null]});return o?e.jsx(C,{to:"/post/"+s.post.user.username+"/"+n,children:v}):e.jsx(e.Fragment,{children:v})}export{W as C};

import{r as n,J as x,p as b,j as t,C as j,N as v,s as P,ax as S}from"./index-BFq9amJe.js";import{S as y}from"./atom-one-dark-Bv4xLXep.js";import{p as N}from"./purify.es-Bq0E5Q3l.js";import{M as T,m as w,H as l}from"./index-qpdfNGLJ.js";const C=new T(w({langPrefix:"hljs language-",highlight(a,s,o){const r=l.getLanguage(s)?s:"plaintext";return l.highlight(a,{language:r}).value}}));function F(){const[a,s]=n.useState({content:"Write your blog post here!",title:"Default Title"}),[o,r]=n.useState({}),u=x("root"),i=b({mutationFn:S}),m=localStorage.getItem("smde_autosavepost")||"Write your blog post here!",p=1e3,d=n.useMemo(()=>({autosave:{enabled:!0,uniqueId:"autosavepost",delay:p},previewRender(e){return N.sanitize(C.parse(e))}}),[]);function c(e){e.preventDefault(e),i.mutate({newBlogPost:a,thumbnail:o})}function g(e){s({...a,content:e})}function h(e){s({...a,[e.target.name]:e.target.value})}function f(e){r({[e.target.name]:e.target.files[0]})}return i.isPending?t.jsx(j,{sx:{position:"absolute",left:"0",right:"0",top:"0",bottom:"0",margin:"auto"}}):i.isSuccess?t.jsx(v,{to:"/post/"+u.username+"/"+P(a.title)}):t.jsxs("div",{id:"create-post",children:[t.jsxs("form",{"aria-label":"Image and title input",className:"post-form",encType:"multipart/form-data",method:"POST",onSubmit:e=>c(e),children:[t.jsxs("div",{className:"flex-row-spacing",children:[t.jsx("label",{className:"file-input-label",htmlFor:"thumbnail",hidden:!0,children:"Thumbnail"}),t.jsx("input",{id:"thumbnail",name:"thumbnail",type:"file",accept:"image/png, image/jpeg",onChange:e=>f(e)}),t.jsx("label",{htmlFor:"title",hidden:!0,children:"Title"}),t.jsx("input",{id:"title",name:"title",onChange:e=>h(e),defaultValue:"My amazing post"})]}),t.jsx("div",{className:"simplemde-wrapper",children:t.jsx(y,{options:d,onChange:g,value:m})}),t.jsx("button",{"data-testid":"submit-button",className:"save-button",type:"submit",children:"Publish"})]}),i.isError?t.jsxs("div",{id:"error-page",children:[t.jsx("h1",{children:"There was an error!"}),t.jsx("p",{children:i.error.message})]}):null]})}export{F as default};

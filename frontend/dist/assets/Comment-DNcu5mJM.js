import{j as e,E as M,r as d,x as R,L as C,al as o,W as z,aj as V,am as y,an as L,Z as T}from"./index-8BmAB2w1.js";import{F as w}from"./FlagButton-DJ2xh2hZ.js";import{c as D}from"./createSvgIcon-DmniPV4F.js";import{C as E}from"./Close-CEMT-WpK.js";import{D as k}from"./Delete-BrlFyoI9.js";import{D as S}from"./Dialog-LhBLWPOI.js";import{E as A}from"./Edit-GfyjZ30b.js";const Y=D(e.jsx("path",{d:"M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 16H5V10h14zM9 14H7v-2h2zm4 0h-2v-2h2zm4 0h-2v-2h2zm-8 4H7v-2h2zm4 0h-2v-2h2zm4 0h-2v-2h2z"}),"CalendarMonth"),B=D(e.jsx("path",{d:"M10 9V5l-7 7 7 7v-4.1c5 0 8.5 1.6 11 5.1-1-5-4-10-11-11"}),"Reply");function U({content:s,isReply:x,isNotification:c,refetch:i,isAdminDashboard:m}){let{slug:n}=M();n||(n=s.post.slug_field);const[j,f]=d.useState(!0),[H,u]=d.useState(!1),[P,h]=d.useState(!1),g=R("root"),[N,a]=d.useState(!1);function b(){a(!1)}function _(t){const l=t.target.dataset.id;y(l).then(r=>{r&&(a(!1),i())})}function F(){y(s.id).then(t=>{t&&(a(!1),i())})}function O(t){t.preventDefault();const l=t.target[1].dataset.id,r=t.target[0].value;L(l,r).then(p=>{p&&(u(!1),i())})}function I(t){t.preventDefault();const l=t.target[0].value,r=t.target[1].dataset.id;T(n,l,r).then(p=>{p&&(h(!1),i())})}const v=e.jsxs(e.Fragment,{children:[e.jsxs("li",{className:(x?"comment comment-reply":"comment")+(s.is_read?" ":" unread-notification"),children:[e.jsxs("div",{className:"top-bar",children:[c?e.jsxs("div",{className:"comment-username-box",children:[j?e.jsx(e.Fragment,{children:s.user.profile_picture!=null?e.jsx("img",{alt:"Profile Picture",className:"pfp",src:s.user.profile_picture,onError:()=>f(!1)}):null}):null,e.jsx("span",{children:s.user.username})]}):e.jsx(C,{to:"/homepage/"+s.user.username,children:e.jsxs("div",{className:"comment-username-box",children:[j?e.jsx(e.Fragment,{children:s.user.profile_picture!=null?e.jsx("img",{alt:"Profile Picture",className:"pfp",src:s.user.profile_picture,onError:()=>f(!1)}):null}):null,e.jsx("span",{children:s.user.username})]})}),e.jsxs("div",{className:"date-field",children:[e.jsxs("div",{className:"sub-date-field",children:[e.jsx(Y,{}),e.jsx("p",{children:o(s.created_date)})]}),o(s.created_date)!=o(s.updated_date)?e.jsxs("p",{className:"edited-on",children:["Edited on ",o(s.updated_date)]}):null]}),e.jsx(w,{type:"comment",isFlaggedParam:s.flagged,content:s})]}),H?e.jsxs("form",{onSubmit:t=>O(t),className:"edit-comment-form",children:[e.jsx("textarea",{}),e.jsxs("div",{className:"edit-buttons",children:[e.jsx("button",{type:"submit",className:"tertiary-accent","data-id":s.id,children:"Save"}),e.jsx("button",{className:"accent-highlight",type:"button",id:"close",onClick:()=>u(!1),children:e.jsx(E,{})})]})]}):e.jsx("p",{className:"comment-content","data-testid":"comment"+s.id,children:s.content}),c?null:e.jsxs("div",{className:"edit-buttons",children:[z()&&!m?e.jsx("button",{onClick:()=>h(!0),children:e.jsx(B,{})}):null,g!=null&&g.username==s.user.username&&!m?e.jsxs("div",{className:"edit-buttons right-align",children:[e.jsx("button",{onClick:()=>a(!0),"data-testid":"delete-comment"+s.id,children:e.jsx(k,{})}),e.jsxs(S,{open:N,className:"delete-post-confirm",onClose:b,children:[e.jsx("h1",{children:"This will delete your comment forever! Are you sure?"}),e.jsx("button",{"data-id":s.id,onClick:t=>_(t),className:"accent-border",children:"Yes, I am sure"}),e.jsx("button",{onClick:b,className:"tertiary-border",children:"No, I'm not"})]}),e.jsx("button",{onClick:()=>u(!0),"data-testid":"delete-comment"+s.id,children:e.jsx(A,{})})]}):null,m&&V()?e.jsxs("div",{className:"flex-row-spacing",children:[e.jsx("button",{onClick:()=>a(!0),children:e.jsx(k,{})}),e.jsxs(S,{open:N,className:"delete-post-confirm",onClose:()=>a(!1),children:[e.jsx("h1",{children:"This will delete SOMEONE ELSE'S COMMENT FOREVER!!! Are you sure?"}),e.jsx("button",{onClick:()=>F(),className:"accent-border",children:"Yes, I am sure"}),e.jsx("button",{onClick:()=>a(!1),className:"tertiary-border",children:"No, I'm not"})]})]}):null]})]}),P?e.jsxs("form",{onSubmit:t=>I(t),className:x?"reply-comment-form edit-comment-form comment-reply":"edit-comment-form reply-comment-form",children:[e.jsx("textarea",{}),e.jsxs("div",{className:"edit-buttons",children:[e.jsx("button",{type:"submit",className:"tertiary-accent","data-id":s.id,children:"Reply"}),e.jsx("button",{className:"accent-highlight",type:"button",id:"close",onClick:()=>h(!1),children:e.jsx(E,{})})]})]}):null]});return c?e.jsx(C,{to:"/post/"+s.post.user.username+"/"+n,children:v}):e.jsx(e.Fragment,{children:v})}export{U as C};

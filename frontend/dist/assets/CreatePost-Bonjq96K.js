import{r as n,x,j as t,C as b,N as j,s as v,a2 as P}from"./index-Dxgc9yJU.js";import{S}from"./atom-one-dark-D1KdraJr.js";import{u as y}from"./useMutation-KslmOtKr.js";import{p as N}from"./purify.es-Bq0E5Q3l.js";import{M as T,m as w,H as l}from"./index-BHrXZhVi.js";import"./utils-km2FGkQ4.js";const C=new T(w({langPrefix:"hljs language-",highlight(a,s,o){const i=l.getLanguage(s)?s:"plaintext";return l.highlight(a,{language:i}).value}}));function E(){const[a,s]=n.useState({content:"Write your blog post here!",title:"Default Title"}),[o,i]=n.useState({}),u=x("root"),r=y({mutationFn:P}),m=localStorage.getItem("smde_autosavepost")||"Write your blog post here!",p=1e3,d=n.useMemo(()=>({autosave:{enabled:!0,uniqueId:"autosavepost",delay:p},previewRender(e){return N.sanitize(C.parse(e))}}),[]);function c(e){e.preventDefault(e),r.mutate({newBlogPost:a,thumbnail:o})}function g(e){s({...a,content:e})}function h(e){s({...a,[e.target.name]:e.target.value})}function f(e){i({[e.target.name]:e.target.files[0]})}return r.isPending?t.jsx(b,{sx:{position:"absolute",left:"0",right:"0",top:"0",bottom:"0",margin:"auto"}}):r.isSuccess?t.jsx(j,{to:"/post/"+u.username+"/"+v(a.title)}):t.jsxs("div",{id:"create-post",children:[t.jsxs("form",{"aria-label":"Image and title input",className:"post-form",encType:"multipart/form-data",method:"POST",onSubmit:e=>c(e),children:[t.jsxs("div",{className:"flex-row-spacing",children:[t.jsx("label",{className:"file-input-label",htmlFor:"thumbnail",hidden:!0,children:"Thumbnail"}),t.jsx("input",{id:"thumbnail",name:"thumbnail",type:"file",accept:"image/png, image/jpeg",onChange:e=>f(e)}),t.jsx("label",{htmlFor:"title",hidden:!0,children:"Title"}),t.jsx("input",{id:"title",name:"title",onChange:e=>h(e),defaultValue:"My amazing post"})]}),t.jsx("div",{className:"simplemde-wrapper",children:t.jsx(S,{options:d,onChange:g,value:m})}),t.jsx("button",{"data-testid":"submit-button",className:"save-button",type:"submit",children:"Publish"})]}),r.isError?t.jsxs("div",{id:"error-page",children:[t.jsx("h1",{children:"There was an error!"}),t.jsx("p",{children:r.error.message})]}):null]})}export{E as default};

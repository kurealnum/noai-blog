import{r as p,u as b,j as e,s as t,D as N,a as T,L as d,b as a,d as L,c as E,e as h,g as x,f as P}from"./index-DKk1ud7V.js";import{E as _}from"./Edit-BffhDzxN.js";function w({content:s,refetch:l,type:r}){const[o,n]=p.useState(!1),j=b();function m(i){let c;r==="list"?c=a("f_EDIT_LIST",["list",i]):r==="blogPost"&&(c=a("f_EDIT_BLOG_POST",["blog-post",i])),j(c)}function g(){L(t(s.title),r).then(i=>{i&&l(),n(!1)})}function u(){n(!1)}return e.jsxs("li",{className:"blog-post",children:[e.jsxs("div",{className:"edit-buttons",children:[" ",e.jsx("button",{onClick:()=>m(t(s.title)),children:e.jsx(_,{})}),e.jsx("button",{onClick:()=>n(!0),children:e.jsx(N,{})}),e.jsxs(T,{open:o,className:"delete-post-confirm",onClose:u,children:[e.jsx("h1",{children:"This will delete your post forever! Are you sure?"}),e.jsx("button",{onClick:()=>g(),className:"accent-border",children:"Yes, I am sure"}),e.jsx("button",{onClick:u,className:"tertiary-border",children:"No, I'm not"})]})]}),e.jsx(d,{to:r=="list"?a("f_GET_LIST",[s.user.username,t(s.title)]):a("f_GET_BLOG_POST",[s.user.username,t(s.title)]),children:e.jsx("h2",{children:s.title})}),e.jsxs("div",{className:"info",children:[e.jsx("p",{children:"By "+s.user.username}),e.jsx("p",{children:s.created_date.replace(/(T.*)/g,"")})]}),e.jsx("p",{className:"hint","data-testid":"post-content",children:s.content.length>100?s.content.slice(0,101)+"...":s.content})]})}function f({query:s,type:l}){return s.isError||s.data===null?e.jsxs("p",{children:["There was an error fetching data"," ",s.error==null?null:": "+s.error.message]}):s.data.length==null?e.jsx("p",{children:"There's nothing here. Go make some posts!"}):e.jsx("ul",{className:"list",children:s.data.map((r,o)=>e.jsx(w,{content:r,refetch:s.refetch,type:l},o))})}function D(){const s=E("root"),l=h({queryKey:["getBlogPosts"],queryFn:()=>x(s.username,"blogPost"),enabled:!!s.username}),r=h({queryKey:["getLists"],queryFn:()=>x(s.username,"list"),enabled:!!s.username});if(l.isLoading||r.isLoading)return e.jsx(P,{});if(l.isError&&r.isError)return e.jsxs("div",{id:"error-page",children:[e.jsx("h1",{children:"There was an error rendering your dashboard!"}),e.jsx("p",{children:l.error.message}),e.jsx("p",{children:r.error.message})]});if(l.isSuccess||r.isSuccess)return e.jsxs("div",{id:"dashboard",children:[e.jsxs("section",{className:"flex-row-spacing vertical-margin-50",children:[e.jsx(d,{to:"/followers",className:"link-button",children:"View followers"}),e.jsx(d,{to:"/following",className:"link-button",children:"View following"})]}),e.jsxs("section",{className:"list-section",children:[e.jsx("h1",{children:"Your posts"}),e.jsx(f,{query:l,type:"blogPost"}),e.jsx("h1",{children:"Your lists"}),e.jsx(f,{query:r,type:"list"})]})]})}export{D as default};

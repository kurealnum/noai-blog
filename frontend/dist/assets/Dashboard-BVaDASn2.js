import{r as p,a as b,j as e,s as i,D as N,b as T,L as c,c as a,d as L,e as E,f as h,g as x,h as P}from"./index-CmO8fXEh.js";import{E as _}from"./Edit-Cv4dRPq9.js";function w({content:s,refetch:l,type:r}){const[o,n]=p.useState(!1),f=b();function m(t){let d;r==="list"?d=a("f_EDIT_LIST",["list",t]):r==="blogPost"&&(d=a("f_EDIT_BLOG_POST",["blog-post",t])),f(d)}function g(){L(i(s.title),r).then(t=>{t&&l(),n(!1)})}function u(){n(!1)}return e.jsxs("li",{className:"blog-post",children:[e.jsxs("div",{className:"edit-buttons",children:[" ",e.jsx("button",{onClick:()=>m(i(s.title)),children:e.jsx(_,{})}),e.jsx("button",{onClick:()=>n(!0),children:e.jsx(N,{})}),e.jsxs(T,{open:o,className:"delete-post-confirm",onClose:u,children:[e.jsx("h1",{children:"This will delete your post forever! Are you sure?"}),e.jsx("button",{onClick:()=>g(),className:"accent-border",children:"Yes, I am sure"}),e.jsx("button",{onClick:u,className:"tertiary-border",children:"No, I'm not"})]})]}),e.jsx(c,{to:r=="list"?a("f_GET_LIST",[s.user.username,i(s.title)]):a("f_GET_BLOG_POST",[s.user.username,i(s.title)]),children:e.jsx("h2",{children:s.title})}),e.jsxs("div",{className:"info",children:[e.jsx("p",{children:"By "+s.user.username}),e.jsx("p",{children:s.created_date.replace(/(T.*)/g,"")})]}),e.jsx("p",{className:"hint","data-testid":"post-content",children:s.content.length>100?s.content.slice(0,101)+"...":s.content})]})}function j({query:s,type:l}){return s.isError||s.data===null?e.jsxs("p",{children:["There was an error fetching data"," ",s.error==null?null:": "+s.error.message]}):s.data.length==null?e.jsx("p",{children:"There's nothing here. Go make some posts!"}):e.jsx("ul",{className:"list",children:s.data.map((r,o)=>e.jsx(w,{content:r,refetch:s.refetch,type:l},o))})}function D(){const s=E("root"),l=h({queryKey:["getBlogPosts"],queryFn:()=>x(s.username,"blogPost"),enabled:!!s.username}),r=h({queryKey:["getLists"],queryFn:()=>x(s.username,"list"),enabled:!!s.username});if(l.isLoading||r.isLoading)return e.jsx(P,{});if(l.isError&&r.isError)return e.jsxs("div",{id:"error-page",children:[e.jsx("h1",{children:"There was an error rendering your dashboard!"}),e.jsx("p",{children:l.error.message}),e.jsx("p",{children:r.error.message})]});if(l.isSuccess||r.isSuccess)return e.jsxs("div",{id:"dashboard",children:[e.jsxs("section",{className:"flex-row-spacing vertical-margin-50",children:[e.jsx("button",{className:"standard-button",children:e.jsx(c,{to:"/followers",children:"View followers"})}),e.jsx("button",{className:"standard-button",children:e.jsx(c,{to:"/following",children:"View following"})})]}),e.jsxs("section",{className:"list-section",children:[e.jsx("h1",{children:"Your posts"}),e.jsx(j,{query:l,type:"blogPost"}),e.jsx("h1",{children:"Your lists"}),e.jsx(j,{query:r,type:"list"})]})]})}export{D as default};
